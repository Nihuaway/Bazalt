Написал общий функционал. Выделил главное, что должно работать на бекенде. 
Но прежде всего надо починить отправку писем